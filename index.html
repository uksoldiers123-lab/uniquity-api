<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Uniquity Solutions â€” Landing Page</title>

  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css?v=9">
  <script src="/env.js"></script>
  <script src="utils/supabaseClient.js" type="module"></script>
</head>
<body>

  <nav class="nav" aria-label="Primary">
    <div class="container nav-inner">
      <a class="brand" href="landing.html">Uniquity Solutions</a>
      <div class="nav-links">
        <a href="landing.html">Home</a>
        <a href="create-account.html">Create Account</a>
        <a href="login.html">Login</a>
      </div>
    </div>
  </nav>

  <main class="container">
    <section class="card" style="max-width:720px; margin: 40px auto;">
      <header class="card-header">
        <h1 class="card-title">Welcome to Uniquity Solutions</h1>
      </header>

      <!-- Account creation form -->
      <form id="createAccountForm" onsubmit="handleCreateAccount(event)">
        <h2>Create Account</h2>
        <label for="newEmail">Email:</label>
        <input type="email" id="newEmail" required>
        <label for="newPassword">Password:</label>
        <input type="password" id="newPassword" required>
        <button type="submit">Create Account</button>
      </form>

      <!-- Login form -->
      <form id="loginForm" onsubmit="handleLogin(event)">
        <h2>Login</h2>
        <label for="loginEmail">Email:</label>
        <input type="email" id="loginEmail" required>
        <label for="loginPassword">Password:</label>
        <input type="password" id="loginPassword" required>
        <button type="submit">Login</button>
      </form>

      <div id="message" style="color: red;"></div>
    </section>
  </main>

  <script>
    import { supabase } from './utils/supabaseClient.js';

    // Handle account creation
    async function handleCreateAccount(event) {
      event.preventDefault();
      const email = document.getElementById('newEmail').value;
      const password = document.getElementById('newPassword').value;

      const { user, error } = await supabase.auth.signUp({ email, password });

      if (error) {
        document.getElementById('message').innerText = error.message;
      } else {
        document.getElementById('message').innerText = 'Account created! Please check your email for verification.';
      }
    }

    // Handle login
    async function handleLogin(event) {
      event.preventDefault();
      const email = document.getElementById('loginEmail').value;
      const password = document.getElementById('loginPassword').value;

      const { user, error } = await supabase.auth.signInWithPassword({ email, password });

      if (error) {
        document.getElementById('message').innerText = error.message;
      } else {
        document.getElementById('message').innerText = 'Login successful!';
        // Redirect to dashboard or another page
        window.location.href = 'dashboard.html'; // Adjust as necessary
      }
    }
  </script>

</body>
</html>
